CommParticipants =
UNION (
    SELECTCOLUMNS (
        comm_emp,
        "comm_id", comm_emp[comm_id],
        "per_id", comm_emp[emp_id]
    ),
    SELECTCOLUMNS (
        comm_con,
        "comm_id", comm_con[comm_id],
        "per_id", comm_con[per_id]
    )
)


CommParticipantSignature =
ADDCOLUMNS (
    SUMMARIZE ( CommParticipants, CommParticipants[comm_id] ),
    "ParticipantKey",
        CONCATENATEX (
            VALUES ( CommParticipants[per_id] ),
            CommParticipants[per_id],
            "|",
            ASC
        )
)


InteractionKey_Participant =
Interaction[created_date] & "|" &
RELATED(Client[name]) & "|" &
RELATED(CommParticipantSignature[ParticipantKey])


ParticipantBasedDuplicateCount =
VAR DuplicateGroups =
    ADDCOLUMNS (
        SUMMARIZE ( Interaction, [InteractionKey_Participant] ),
        "DupCount",
            CALCULATE ( COUNTROWS ( Interaction ) )
    )
RETURN
SUMX (
    FILTER ( DuplicateGroups, [DupCount] > 1 ),
    [DupCount]
)


